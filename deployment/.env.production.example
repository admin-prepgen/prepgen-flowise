# Production Environment Configuration for Flowise on Cloud Run
# Copy this file to .env.production and update with your actual values

#############################################################################################################
############################################## PROJECT CONFIG ###############################################
#############################################################################################################

# Your GCP project ID
PROJECT_ID=your-gcp-project-id

# GCP region where resources are deployed
REGION=us-central1

# Artifact Registry repository name (must match Terraform output)
REPOSITORY=flowise-repo

#############################################################################################################
############################################## CORE SETTINGS ################################################
#############################################################################################################

# Application ports (Cloud Run handles external port mapping)
PORT=3000
WORKER_PORT=5566

# Application mode (set automatically by Cloud Run deployment)
# MODE=main  # for main service
# MODE=worker # for worker service

#############################################################################################################
############################################## DATABASE ######################################################
#############################################################################################################

# Database configuration (managed by Secret Manager in production)
DATABASE_TYPE=postgres
DATABASE_PORT=5432
DATABASE_SSL=true

# These values are automatically populated from Secret Manager secrets:
# DATABASE_HOST (from secret: flowise-db-config.host)
# DATABASE_NAME (from secret: flowise-db-config.database)
# DATABASE_USER (from secret: flowise-db-config.username)
# DATABASE_PASSWORD (from secret: flowise-db-config.password)

#############################################################################################################
############################################## STORAGE #######################################################
#############################################################################################################

# Google Cloud Storage configuration
STORAGE_TYPE=gcs
GOOGLE_CLOUD_STORAGE_PROJ_ID=${PROJECT_ID}
GOOGLE_CLOUD_STORAGE_BUCKET_NAME=${PROJECT_ID}-flowise-storage
GOOGLE_CLOUD_UNIFORM_BUCKET_ACCESS=true

#############################################################################################################
############################################## QUEUE/REDIS ###################################################
#############################################################################################################

# Redis configuration (managed by Secret Manager in production)
REDIS_PORT=6379
QUEUE_NAME=flowise-queue
WORKER_CONCURRENCY=5

# These values are automatically populated from Secret Manager secrets:
# REDIS_HOST (from secret: flowise-redis-config.host)
# REDIS_PASSWORD (from secret: flowise-redis-config.auth_string)

#############################################################################################################
############################################## SECRET KEYS ###################################################
#############################################################################################################

# Secret storage
SECRETKEY_STORAGE_TYPE=local
SECRETKEY_PATH=/tmp/.flowise

# JWT configuration (secrets managed by Secret Manager in production)
JWT_ISSUER=flowise-prepgen
JWT_AUDIENCE=flowise-users
JWT_TOKEN_EXPIRY_IN_MINUTES=360
JWT_REFRESH_TOKEN_EXPIRY_IN_MINUTES=43200

# These values are automatically populated from Secret Manager secrets:
# JWT_AUTH_TOKEN_SECRET (from secret: flowise-auth-secrets.jwt_token_secret)
# JWT_REFRESH_TOKEN_SECRET (from secret: flowise-auth-secrets.jwt_refresh_token_secret)

#############################################################################################################
############################################## LOGGING #######################################################
#############################################################################################################

# Logging configuration
LOG_LEVEL=info
LOG_PATH=/tmp/.flowise/logs
DEBUG=false

# Tool function dependencies
TOOL_FUNCTION_BUILTIN_DEP=crypto,fs

#############################################################################################################
############################################## APP SETTINGS ###################################################
#############################################################################################################

# CORS and security
CORS_ORIGINS=*
IFRAME_ORIGINS=*

# File upload limits
FLOWISE_FILE_SIZE_LIMIT=50mb

# Features
SHOW_COMMUNITY_NODES=true
DISABLE_FLOWISE_TELEMETRY=true

# Cloud Run specific optimizations
NUMBER_OF_PROXIES=1

#############################################################################################################
############################################## ENTERPRISE ####################################################
#############################################################################################################

# Uncomment and configure if using Flowise Enterprise Edition
# LICENSE_URL=
# FLOWISE_EE_LICENSE_KEY=
# OFFLINE=false

#############################################################################################################
############################################## MONITORING ####################################################
#############################################################################################################

# Metrics collection (optional)
# ENABLE_METRICS=true
# METRICS_PROVIDER=prometheus
# METRICS_INCLUDE_NODE_METRICS=true
# METRICS_SERVICE_NAME=FlowiseAI

#############################################################################################################
############################################## EMAIL/SMTP ####################################################
#############################################################################################################

# Email configuration (optional)
# SMTP_HOST=smtp.gmail.com
# SMTP_PORT=587
# SMTP_USER=your-email@gmail.com
# SMTP_PASSWORD=your-app-password
# SMTP_SECURE=true
# SENDER_EMAIL=your-email@gmail.com
